{% for group in devices[inventory_hostname].group %}
{% if devices[inventory_hostname].group[group].md5 is defined %}
set protocols bgp group {{ group }} neighbor {{ devices[inventory_hostname].group[group].peer }} description "{{ devices[inventory_hostname].group[group].description }}"
set protocols bgp group {{ group }} neighbor {{ devices[inventory_hostname].group[group].peer }} authentication-key {{ devices[inventory_hostname].group[group].md5 }}
set protocols bgp group {{ group }} neighbor {{ devices[inventory_hostname].group[group].peer }} peer-as {{ devices[inventory_hostname].group[group].peer_as }}
{% else %}
set protocols bgp group {{ group }} neighbor {{ devices[inventory_hostname].group[group].peer }} description "{{ devices[inventory_hostname].group[group].description }}"
set protocols bgp group {{ group }} neighbor {{ devices[inventory_hostname].group[group].peer }} peer-as {{ devices[inventory_hostname].group[group].peer_as  }}
{% endif %}
{% endfor %}